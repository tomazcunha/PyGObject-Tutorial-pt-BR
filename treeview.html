

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>11. Widgets de Árvore e Lista &mdash; documentação Python GTK+ 3 Tutorial 3.4</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Índice"
              href="genindex.html"/>
        <link rel="search" title="Buscar" href="search.html"/>
    <link rel="top" title="documentação Python GTK+ 3 Tutorial 3.4" href="index.html"/>
        <link rel="next" title="12. CellRenderers" href="cellrenderers.html"/>
        <link rel="prev" title="10. Spinner" href="spinner.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Python GTK+ 3 Tutorial
          

          
          </a>

          
            
            
              <div class="version">
                3.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">1. Instalação</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">2. Começando</a></li>
<li class="toctree-l1"><a class="reference internal" href="basics.html">3. Noções básicas</a></li>
<li class="toctree-l1"><a class="reference internal" href="unicode.html">4. Como Lidar com Sequências de Caracteres</a></li>
<li class="toctree-l1"><a class="reference internal" href="layout.html">5. Containers de Layout</a></li>
<li class="toctree-l1"><a class="reference internal" href="label.html">6. Label</a></li>
<li class="toctree-l1"><a class="reference internal" href="entry.html">7. Entry</a></li>
<li class="toctree-l1"><a class="reference internal" href="button_widgets.html">8. Widgets de Botão</a></li>
<li class="toctree-l1"><a class="reference internal" href="progressbar.html">9. Barra de Progresso</a></li>
<li class="toctree-l1"><a class="reference internal" href="spinner.html">10. Spinner</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">11. Widgets de Árvore e Lista</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-model">11.1. O Modelo</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-view">11.2. A View</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-selection">11.3. A Seleção</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sorting">11.4. Classificação</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sorting-by-clicking-on-columns">11.4.1. Classificando clicando em colunas</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setting-a-custom-sort-function">11.4.2. Definindo uma função de classificação personalizada</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#filtering">11.5. Filtrando</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cellrenderers.html">12. CellRenderers</a></li>
<li class="toctree-l1"><a class="reference internal" href="combobox.html">13. ComboBox</a></li>
<li class="toctree-l1"><a class="reference internal" href="iconview.html">14. IconView</a></li>
<li class="toctree-l1"><a class="reference internal" href="textview.html">15. Editor de Texto Multilinha</a></li>
<li class="toctree-l1"><a class="reference internal" href="dialogs.html">16. Dialogs</a></li>
<li class="toctree-l1"><a class="reference internal" href="popover.html">17. Popovers</a></li>
<li class="toctree-l1"><a class="reference internal" href="clipboard.html">18. Clipboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="drag_and_drop.html">19. Arraste e solte</a></li>
<li class="toctree-l1"><a class="reference internal" href="builder.html">20. Glade e Gtk.Builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="objects.html">21. Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="application.html">22. Aplicação</a></li>
</ul>
<p class="caption"><span class="caption-text">Descontinuada</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="menus.html">Menus</a></li>
<li class="toctree-l1"><a class="reference internal" href="layout-table.html">Tabela</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Python GTK+ 3 Tutorial</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>11. Widgets de Árvore e Lista</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/treeview.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tree-and-list-widgets">
<h1>11. Widgets de Árvore e Lista<a class="headerlink" href="#tree-and-list-widgets" title="Link permanente para este título">¶</a></h1>
<p>A <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeView.html#Gtk.TreeView" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeView</span></code></a> e seus widgets associados são uma maneira extremamente poderosa de exibir dados. Eles são usados em conjunto com um <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/ListStore.html#Gtk.ListStore" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.ListStore</span></code></a> ou <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeStore.html#Gtk.TreeStore" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeStore</span></code></a> e fornecem uma maneira de exibir e manipular dados de várias maneiras, incluindo:</p>
<blockquote>
<div><ul class="simple">
<li>Atualiza automaticamente quando os dados são adicionados, removidos ou editados</li>
<li>Suporte a Arrastar e Soltar</li>
<li>Classificação de dados</li>
<li>Suporte a incorporação de widgets, como caixas de seleção, barras de progresso, etc.</li>
<li>Colunas reordenáveis e redimensionáveis</li>
<li>Filtragem de dados</li>
</ul>
</div></blockquote>
<p>Com o poder e a flexibilidade de um <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeView.html#Gtk.TreeView" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeView</span></code></a> vem a complexidade. Geralmente, é difícil para os desenvolvedores iniciantes serem capazes de utilizá-lo corretamente devido ao número de métodos necessários.</p>
<div class="section" id="the-model">
<h2>11.1. O Modelo<a class="headerlink" href="#the-model" title="Link permanente para este título">¶</a></h2>
<p>Cada <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeView.html#Gtk.TreeView" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeView</span></code></a> possui um <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeModel.html#Gtk.TreeModel" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeModel</span></code></a>, que contém os dados exibidos pelo TreeView. Cada <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeModel.html#Gtk.TreeModel" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeModel</span></code></a> pode ser usado por mais de um <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeView.html#Gtk.TreeView" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeView</span></code></a>. Por exemplo, isso permite que os mesmos dados subjacentes sejam exibidos e editados de duas maneiras diferentes ao mesmo tempo. Ou os 2 modos de exibição podem exibir colunas diferentes dos mesmos dados do modelo, da mesma forma que duas consultas SQL (ou “visualizações”) podem mostrar campos diferentes da mesma tabela de banco de dados.</p>
<p>Embora você possa teoricamente implementar seu próprio Modelo, você normalmente usará as classes de modelo <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/ListStore.html#Gtk.ListStore" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.ListStore</span></code></a> ou <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeStore.html#Gtk.TreeStore" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeStore</span></code></a>. <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/ListStore.html#Gtk.ListStore" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.ListStore</span></code></a> contém linhas simples de dados, e cada linha não tem filhos, enquanto <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeStore.html#Gtk.TreeStore" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeStore</span></code></a> contém linhas de dados, e cada linha pode ter linhas filhas.</p>
<p>Ao construir um modelo, você deve especificar os tipos de dados para cada coluna que o modelo contém.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">store</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">ListStore</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
<p>Isso cria um armazenamento de lista com três colunas, duas colunas de string e uma coluna flutuante.</p>
<p>A adição de dados ao modelo é feita usando <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/ListStore.html#Gtk.ListStore.append" title="(em Gtk 3.0 v3.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gtk.ListStore.append()</span></code></a> ou <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeStore.html#Gtk.TreeStore.append" title="(em Gtk 3.0 v3.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gtk.TreeStore.append()</span></code></a>, dependendo de qual tipo de modelo foi criado.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">treeiter</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s2">&quot;The Art of Computer Programming&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;Donald E. Knuth&quot;</span><span class="p">,</span> <span class="mf">25.46</span><span class="p">])</span>
</pre></div>
</div>
<p>Ambos os métodos retornam uma instância <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeIter.html#Gtk.TreeIter" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeIter</span></code></a>, que aponta para a localização da linha recém-inserida. Você pode recuperar um <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeIter.html#Gtk.TreeIter" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeIter</span></code></a> chamando <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeModel.html#Gtk.TreeModel.get_iter" title="(em Gtk 3.0 v3.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gtk.TreeModel.get_iter()</span></code></a>.</p>
<p>Depois que os dados foram inseridos, você pode recuperar ou modificar dados usando o iterador de árvore e o índice de coluna.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">store</span><span class="p">[</span><span class="n">treeiter</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span> <span class="c1"># Prints value of third column</span>
<span class="n">store</span><span class="p">[</span><span class="n">treeiter</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">42.15</span>
</pre></div>
</div>
<p>Assim como no objeto built-in <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> do Python, você pode usar <code class="xref py py-func docutils literal notranslate"><span class="pre">len()</span></code> para obter o número de linhas e usar fatias para recuperar ou definir valores.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print number of rows</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">store</span><span class="p">))</span>
<span class="c1"># Print all but first column</span>
<span class="k">print</span><span class="p">(</span><span class="n">store</span><span class="p">[</span><span class="n">treeiter</span><span class="p">][</span><span class="mi">1</span><span class="p">:])</span>
<span class="c1"># Print last column</span>
<span class="k">print</span><span class="p">(</span><span class="n">store</span><span class="p">[</span><span class="n">treeiter</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="c1"># Set last two columns</span>
<span class="n">store</span><span class="p">[</span><span class="n">treeiter</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Donald Ervin Knuth&quot;</span><span class="p">,</span> <span class="mf">41.99</span><span class="p">]</span>
</pre></div>
</div>
<p>Iterar sobre todas as linhas de um modelo de árvore é muito simples também.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">store</span><span class="p">:</span>
    <span class="c1"># Print values of all columns</span>
    <span class="k">print</span><span class="p">(</span><span class="n">row</span><span class="p">[:])</span>
</pre></div>
</div>
<p>Tenha em mente que, se você usar <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeStore.html#Gtk.TreeStore" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeStore</span></code></a>, o código acima irá apenas iterar sobre as linhas do nível superior, mas não os filhos dos nós. Para iterar sobre todas as linhas e seus filhos, use a função <code class="docutils literal notranslate"><span class="pre">print_tree_store</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">print_tree_store</span><span class="p">(</span><span class="n">store</span><span class="p">):</span>
    <span class="n">rootiter</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">get_iter_first</span><span class="p">()</span>
    <span class="n">print_rows</span><span class="p">(</span><span class="n">store</span><span class="p">,</span> <span class="n">rootiter</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">print_rows</span><span class="p">(</span><span class="n">store</span><span class="p">,</span> <span class="n">treeiter</span><span class="p">,</span> <span class="n">indent</span><span class="p">):</span>
    <span class="k">while</span> <span class="n">treeiter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">indent</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">store</span><span class="p">[</span><span class="n">treeiter</span><span class="p">][:]))</span>
        <span class="k">if</span> <span class="n">store</span><span class="o">.</span><span class="n">iter_has_child</span><span class="p">(</span><span class="n">treeiter</span><span class="p">):</span>
            <span class="n">childiter</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">iter_children</span><span class="p">(</span><span class="n">treeiter</span><span class="p">)</span>
            <span class="n">print_rows</span><span class="p">(</span><span class="n">store</span><span class="p">,</span> <span class="n">childiter</span><span class="p">,</span> <span class="n">indent</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">treeiter</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">iter_next</span><span class="p">(</span><span class="n">treeiter</span><span class="p">)</span>
</pre></div>
</div>
<p>Além de acessar valores armazenados em um <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeModel.html#Gtk.TreeModel" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeModel</span></code></a> com o método list-like mencionado acima, também é possível usar as instâncias <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeIter.html#Gtk.TreeIter" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeIter</span></code></a> ou <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreePath.html#Gtk.TreePath" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreePath</span></code></a>. Ambos fazem referência a uma linha específica em um modelo de árvore. Pode-se converter um caminho para um iterador chamando <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeModel.html#Gtk.TreeModel.get_iter" title="(em Gtk 3.0 v3.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gtk.TreeModel.get_iter()</span></code></a>. Como <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/ListStore.html#Gtk.ListStore" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.ListStore</span></code></a> contém apenas um nível, ou seja, nós não têm nenhum nó filho, um caminho é essencialmente o índice da linha que você deseja acessar.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get path pointing to 6th row in list store</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">TreePath</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">treeiter</span> <span class="o">=</span> <span class="n">liststore</span><span class="o">.</span><span class="n">get_iter</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="c1"># Get value at 2nd column</span>
<span class="n">value</span> <span class="o">=</span> <span class="n">liststore</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">treeiter</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>No caso de <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeStore.html#Gtk.TreeStore" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeStore</span></code></a>, um caminho é uma lista de índices ou uma string. O formulário de string é uma lista de números separados por dois pontos. Cada número refere-se ao deslocamento nesse nível. Assim, o caminho “0” refere-se ao nó raiz e o caminho “2: 4” refere-se ao quinto filho do terceiro nó.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get path pointing to 5th child of 3rd row in tree store</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">TreePath</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">treeiter</span> <span class="o">=</span> <span class="n">treestore</span><span class="o">.</span><span class="n">get_iter</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="c1"># Get value at 2nd column</span>
<span class="n">value</span> <span class="o">=</span> <span class="n">treestore</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">treeiter</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Instâncias de <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreePath.html#Gtk.TreePath" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreePath</span></code></a> podem ser acessadas como listas, <code class="docutils literal notranslate"><span class="pre">len(treepath)</span></code> retorna a profundidade do item <code class="docutils literal notranslate"><span class="pre">treepath</span></code> está apontando para, e <code class="docutils literal notranslate"><span class="pre">treepath[i]</span></code> retorna o índice do filho no nível <em>i</em>.</p>
</div>
<div class="section" id="the-view">
<h2>11.2. A View<a class="headerlink" href="#the-view" title="Link permanente para este título">¶</a></h2>
<p>Embora existam vários modelos diferentes para escolher, há apenas um widget de visualização para lidar. Funciona com a lista ou com o armazenamento em árvore. Configurar um <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeView.html#Gtk.TreeView" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeView</span></code></a> não é uma tarefa difícil. Ele precisa de um <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeModel.html#Gtk.TreeModel" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeModel</span></code></a> para saber de onde recuperar seus dados, seja passando-o para o construtor <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeView.html#Gtk.TreeView" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeView</span></code></a>, ou chamando <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeView.html#Gtk.TreeView.set_model" title="(em Gtk 3.0 v3.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gtk.TreeView.set_model()</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tree</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">TreeView</span><span class="p">(</span><span class="n">store</span><span class="p">)</span>
</pre></div>
</div>
<p>Uma vez que o widget <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeView.html#Gtk.TreeView" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeView</span></code></a> possua um modelo, ele precisará saber como exibir o modelo. Ele faz isso com colunas e renderizadores de célula.</p>
<p>Os renderizadores de célula são usados para desenhar os dados no modelo de árvore de uma maneira. Existem vários renderizadores de célula que vêm com o GTK+, por exemplo <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/CellRendererText.html#Gtk.CellRendererText" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.CellRendererText</span></code></a>, <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/CellRendererPixbuf.html#Gtk.CellRendererPixbuf" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.CellRendererPixbuf</span></code></a> e <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/CellRendererToggle.html#Gtk.CellRendererToggle" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.CellRendererToggle</span></code></a>. Além disso, é relativamente fácil escrever um renderizador personalizado por conta própria.</p>
<p>A <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeViewColumn.html#Gtk.TreeViewColumn" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeViewColumn</span></code></a> é o objeto que <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeView.html#Gtk.TreeView" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeView</span></code></a> usa para organizar as colunas verticais na visualização em árvore. Ele precisa saber o nome da coluna para rotular o usuário, que tipo de renderizador de célula deve ser usado e qual parte dos dados deve ser recuperada do modelo para uma determinada linha.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">renderer</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">CellRendererText</span><span class="p">()</span>
<span class="n">column</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">TreeViewColumn</span><span class="p">(</span><span class="s2">&quot;Title&quot;</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">append_column</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
</pre></div>
</div>
<p>Para renderizar mais de uma coluna de modelo em uma coluna de visão, você precisa criar uma instância <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeViewColumn.html#Gtk.TreeViewColumn" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeViewColumn</span></code></a> e usar <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeViewColumn.html#Gtk.TreeViewColumn.pack_start" title="(em Gtk 3.0 v3.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gtk.TreeViewColumn.pack_start()</span></code></a> para adicionar as colunas de modelo a ela.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">column</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">TreeViewColumn</span><span class="p">(</span><span class="s2">&quot;Title and Author&quot;</span><span class="p">)</span>

<span class="n">title</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">CellRendererText</span><span class="p">()</span>
<span class="n">author</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">CellRendererText</span><span class="p">()</span>

<span class="n">column</span><span class="o">.</span><span class="n">pack_start</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">column</span><span class="o">.</span><span class="n">pack_start</span><span class="p">(</span><span class="n">author</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>

<span class="n">column</span><span class="o">.</span><span class="n">add_attribute</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">column</span><span class="o">.</span><span class="n">add_attribute</span><span class="p">(</span><span class="n">author</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">tree</span><span class="o">.</span><span class="n">append_column</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="the-selection">
<h2>11.3. A Seleção<a class="headerlink" href="#the-selection" title="Link permanente para este título">¶</a></h2>
<p>A maioria dos aplicativos precisará não apenas lidar com a exibição de dados, mas também receber eventos de entrada dos usuários. Para fazer isso, basta obter uma referência a um objeto de seleção e conectar-se ao sinal “changed”.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">get_selection</span><span class="p">()</span>
<span class="n">select</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;changed&quot;</span><span class="p">,</span> <span class="n">on_tree_selection_changed</span><span class="p">)</span>
</pre></div>
</div>
<p>Em seguida, para recuperar dados para a linha selecionada:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">on_tree_selection_changed</span><span class="p">(</span><span class="n">selection</span><span class="p">):</span>
    <span class="n">model</span><span class="p">,</span> <span class="n">treeiter</span> <span class="o">=</span> <span class="n">selection</span><span class="o">.</span><span class="n">get_selected</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">treeiter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;You selected&quot;</span><span class="p">,</span> <span class="n">model</span><span class="p">[</span><span class="n">treeiter</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>Você pode controlar quais seleções são permitidas chamando <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeSelection.html#Gtk.TreeSelection.set_mode" title="(em Gtk 3.0 v3.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gtk.TreeSelection.set_mode()</span></code></a>. <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeSelection.html#Gtk.TreeSelection.get_selected" title="(em Gtk 3.0 v3.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gtk.TreeSelection.get_selected()</span></code></a> não funciona se o modo de seleção estiver definido como <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/enums.html#Gtk.SelectionMode.MULTIPLE" title="(em Gtk 3.0 v3.0)"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Gtk.SelectionMode.MULTIPLE</span></code></a>, use <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeSelection.html#Gtk.TreeSelection.get_selected_rows" title="(em Gtk 3.0 v3.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gtk.TreeSelection.get_selected_rows()</span></code></a>.</p>
</div>
<div class="section" id="sorting">
<h2>11.4. Classificação<a class="headerlink" href="#sorting" title="Link permanente para este título">¶</a></h2>
<p>A classificação é um recurso importante para as visualizações em árvore e é suportada pelos modelos de árvore padrão (<a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeStore.html#Gtk.TreeStore" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeStore</span></code></a> e <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/ListStore.html#Gtk.ListStore" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.ListStore</span></code></a>), que implementam a interface <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeSortable.html#Gtk.TreeSortable" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeSortable</span></code></a>.</p>
<div class="section" id="sorting-by-clicking-on-columns">
<h3>11.4.1. Classificando clicando em colunas<a class="headerlink" href="#sorting-by-clicking-on-columns" title="Link permanente para este título">¶</a></h3>
<p>Uma coluna de um <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeView.html#Gtk.TreeView" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeView</span></code></a> pode ser facilmente ordenada com uma chamada para <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeViewColumn.html#Gtk.TreeViewColumn.set_sort_column_id" title="(em Gtk 3.0 v3.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gtk.TreeViewColumn.set_sort_column_id()</span></code></a>. Depois, a coluna pode ser ordenada clicando no cabeçalho.</p>
<p>Primeiro precisamos de um simples <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeView.html#Gtk.TreeView" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeView</span></code></a> e um <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/ListStore.html#Gtk.ListStore" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.ListStore</span></code></a> como modelo.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">ListStore</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s2">&quot;Benjamin&quot;</span><span class="p">])</span>
<span class="n">model</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s2">&quot;Charles&quot;</span><span class="p">])</span>
<span class="n">model</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s2">&quot;alfred&quot;</span><span class="p">])</span>
<span class="n">model</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s2">&quot;Alfred&quot;</span><span class="p">])</span>
<span class="n">model</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s2">&quot;David&quot;</span><span class="p">])</span>
<span class="n">model</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s2">&quot;charles&quot;</span><span class="p">])</span>
<span class="n">model</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s2">&quot;david&quot;</span><span class="p">])</span>
<span class="n">model</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s2">&quot;benjamin&quot;</span><span class="p">])</span>

<span class="n">treeView</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">TreeView</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="n">cellRenderer</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">CellRendererText</span><span class="p">()</span>
<span class="n">column</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">TreeViewColumn</span><span class="p">(</span><span class="s2">&quot;Title&quot;</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>O próximo passo é ativar a classificação. Note que o <em>column_id</em> (<code class="docutils literal notranslate"><span class="pre">0</span></code> no exemplo) refere-se à coluna do modelo e <strong>não</strong> à coluna do TreeView.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">column</span><span class="o">.</span><span class="n">set_sort_column_id</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="setting-a-custom-sort-function">
<h3>11.4.2. Definindo uma função de classificação personalizada<a class="headerlink" href="#setting-a-custom-sort-function" title="Link permanente para este título">¶</a></h3>
<p>Também é possível definir uma função de comparação personalizada para alterar o comportamento de classificação. Como exemplo, criaremos uma função de comparação que classifica maiúsculas e minúsculas. No exemplo acima, a lista classificada parecia com:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">alfred</span>
<span class="n">Alfred</span>
<span class="n">benjamin</span>
<span class="n">Benjamin</span>
<span class="n">charles</span>
<span class="n">Charles</span>
<span class="n">david</span>
<span class="n">David</span>
</pre></div>
</div>
<p>A lista classificada com distinção entre maiúsculas e minúsculas será semelhante a:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Alfred</span>
<span class="n">Benjamin</span>
<span class="n">Charles</span>
<span class="n">David</span>
<span class="n">alfred</span>
<span class="n">benjamin</span>
<span class="n">charles</span>
<span class="n">david</span>
</pre></div>
</div>
<p>Em primeiro lugar, é necessária uma função de comparação. Esta função obtém duas linhas e tem que retornar um inteiro negativo se o primeiro deve vir antes do segundo, zero se eles forem iguais e um inteiro positivo se o segundo vier antes do primeiro.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compare</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">row1</span><span class="p">,</span> <span class="n">row2</span><span class="p">,</span> <span class="n">user_data</span><span class="p">):</span>
    <span class="n">sort_column</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_sort_column_id</span><span class="p">()</span>
    <span class="n">value1</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">row1</span><span class="p">,</span> <span class="n">sort_column</span><span class="p">)</span>
    <span class="n">value2</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">row2</span><span class="p">,</span> <span class="n">sort_column</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">value1</span> <span class="o">&lt;</span> <span class="n">value2</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">elif</span> <span class="n">value1</span> <span class="o">==</span> <span class="n">value2</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
</pre></div>
</div>
<p>Então a função sort deve ser definida por <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeSortable.html#Gtk.TreeSortable.set_sort_func" title="(em Gtk 3.0 v3.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gtk.TreeSortable.set_sort_func()</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">set_sort_func</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">compare</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="filtering">
<h2>11.5. Filtrando<a class="headerlink" href="#filtering" title="Link permanente para este título">¶</a></h2>
<p>Ao contrário da classificação, a filtragem não é tratada pelos dois modelos que vimos anteriormente, mas pela classe <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeModelFilter.html#Gtk.TreeModelFilter" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeModelFilter</span></code></a>. Esta classe, como <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeStore.html#Gtk.TreeStore" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeStore</span></code></a> e <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/ListStore.html#Gtk.ListStore" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.ListStore</span></code></a>, é uma <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeModel.html#Gtk.TreeModel" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeModel</span></code></a>. Ele age como uma camada entre o modelo “real” (a <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeStore.html#Gtk.TreeStore" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeStore</span></code></a> ou a <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/ListStore.html#Gtk.ListStore" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.ListStore</span></code></a>), ocultando alguns elementos para a view. Na prática, ele fornece o <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeView.html#Gtk.TreeView" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeView</span></code></a> com um subconjunto do modelo subjacente. Instâncias de <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeModelFilter.html#Gtk.TreeModelFilter" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeModelFilter</span></code></a> podem ser empilhadas umas sobre as outras, para usar múltiplos filtros no mesmo modelo (da mesma forma que você usaria cláusulas “AND” em uma requisição SQL). Eles também podem ser encadeados com instâncias <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeModelSort.html#Gtk.TreeModelSort" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeModelSort</span></code></a>.</p>
<p>Você pode criar uma nova instância de <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeModelFilter.html#Gtk.TreeModelFilter" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeModelFilter</span></code></a> e dar a ela um modelo para filtrar, mas a maneira mais fácil é gerá-lo diretamente do modelo filtrado, usando o método <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeModel.html#Gtk.TreeModel.filter_new" title="(em Gtk 3.0 v3.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gtk.TreeModel.filter_new()</span></code></a> método.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">filter</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">filter_new</span><span class="p">()</span>
</pre></div>
</div>
<p>Da mesma forma que funciona a função de classificação, o <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeModelFilter.html#Gtk.TreeModelFilter" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeModelFilter</span></code></a> precisa de uma função de “visibilidade”, que, dada uma linha do modelo subjacente, retornará um booleano indicando se essa linha deve ser filtrada ou não. É definido por <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeModelFilter.html#Gtk.TreeModelFilter.set_visible_func" title="(em Gtk 3.0 v3.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gtk.TreeModelFilter.set_visible_func()</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">filter</span><span class="o">.</span><span class="n">set_visible_func</span><span class="p">(</span><span class="n">filter_func</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</pre></div>
</div>
<p>Vejamos um exemplo completo que usa a pilha inteira <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/ListStore.html#Gtk.ListStore" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.ListStore</span></code></a> - <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeModelFilter.html#Gtk.TreeModelFilter" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeModelFilter</span></code></a> - <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeModelFilter.html#Gtk.TreeModelFilter" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeModelFilter</span></code></a> - <a class="reference external" href="https://lazka.github.io/pgi-docs/Gtk-3.0/classes/TreeView.html#Gtk.TreeView" title="(em Gtk 3.0 v3.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gtk.TreeView</span></code></a>.</p>
<img alt="_images/treeview_filter_example.png" src="_images/treeview_filter_example.png" />
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gi</span>
<span class="n">gi</span><span class="o">.</span><span class="n">require_version</span><span class="p">(</span><span class="s1">&#39;Gtk&#39;</span><span class="p">,</span> <span class="s1">&#39;3.0&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">gi.repository</span> <span class="k">import</span> <span class="n">Gtk</span>

<span class="c1">#list of tuples for each software, containing the software name, initial release, and main programming languages used</span>
<span class="n">software_list</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;Firefox&quot;</span><span class="p">,</span> <span class="mi">2002</span><span class="p">,</span>  <span class="s2">&quot;C++&quot;</span><span class="p">),</span>
                 <span class="p">(</span><span class="s2">&quot;Eclipse&quot;</span><span class="p">,</span> <span class="mi">2004</span><span class="p">,</span> <span class="s2">&quot;Java&quot;</span> <span class="p">),</span>
                 <span class="p">(</span><span class="s2">&quot;Pitivi&quot;</span><span class="p">,</span> <span class="mi">2004</span><span class="p">,</span> <span class="s2">&quot;Python&quot;</span><span class="p">),</span>
                 <span class="p">(</span><span class="s2">&quot;Netbeans&quot;</span><span class="p">,</span> <span class="mi">1996</span><span class="p">,</span> <span class="s2">&quot;Java&quot;</span><span class="p">),</span>
                 <span class="p">(</span><span class="s2">&quot;Chrome&quot;</span><span class="p">,</span> <span class="mi">2008</span><span class="p">,</span> <span class="s2">&quot;C++&quot;</span><span class="p">),</span>
                 <span class="p">(</span><span class="s2">&quot;Filezilla&quot;</span><span class="p">,</span> <span class="mi">2001</span><span class="p">,</span> <span class="s2">&quot;C++&quot;</span><span class="p">),</span>
                 <span class="p">(</span><span class="s2">&quot;Bazaar&quot;</span><span class="p">,</span> <span class="mi">2005</span><span class="p">,</span> <span class="s2">&quot;Python&quot;</span><span class="p">),</span>
                 <span class="p">(</span><span class="s2">&quot;Git&quot;</span><span class="p">,</span> <span class="mi">2005</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">),</span>
                 <span class="p">(</span><span class="s2">&quot;Linux Kernel&quot;</span><span class="p">,</span> <span class="mi">1991</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">),</span>
                 <span class="p">(</span><span class="s2">&quot;GCC&quot;</span><span class="p">,</span> <span class="mi">1987</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">),</span>
                 <span class="p">(</span><span class="s2">&quot;Frostwire&quot;</span><span class="p">,</span> <span class="mi">2004</span><span class="p">,</span> <span class="s2">&quot;Java&quot;</span><span class="p">)]</span>

<span class="k">class</span> <span class="nc">TreeViewFilterWindow</span><span class="p">(</span><span class="n">Gtk</span><span class="o">.</span><span class="n">Window</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Gtk</span><span class="o">.</span><span class="n">Window</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Treeview Filter Demo&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_border_width</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

        <span class="c1">#Setting up the self.grid in which the elements are to be positionned</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Grid</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">set_column_homogeneous</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">set_row_homogeneous</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="p">)</span>

        <span class="c1">#Creating the ListStore model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">software_liststore</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">ListStore</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">software_ref</span> <span class="ow">in</span> <span class="n">software_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">software_liststore</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">software_ref</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_filter_language</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1">#Creating the filter, feeding it with the liststore model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">language_filter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">software_liststore</span><span class="o">.</span><span class="n">filter_new</span><span class="p">()</span>
        <span class="c1">#setting the filter function, note that we&#39;re not using the</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">language_filter</span><span class="o">.</span><span class="n">set_visible_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">language_filter_func</span><span class="p">)</span>

        <span class="c1">#creating the treeview, making it use the filter as a model, and adding the columns</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">treeview</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">TreeView</span><span class="o">.</span><span class="n">new_with_model</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">language_filter</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">column_title</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="s2">&quot;Software&quot;</span><span class="p">,</span> <span class="s2">&quot;Release Year&quot;</span><span class="p">,</span> <span class="s2">&quot;Programming Language&quot;</span><span class="p">]):</span>
            <span class="n">renderer</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">CellRendererText</span><span class="p">()</span>
            <span class="n">column</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">TreeViewColumn</span><span class="p">(</span><span class="n">column_title</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">treeview</span><span class="o">.</span><span class="n">append_column</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>

        <span class="c1">#creating buttons to filter by programming language, and setting up their events</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">prog_language</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Java&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;C++&quot;</span><span class="p">,</span> <span class="s2">&quot;Python&quot;</span><span class="p">,</span> <span class="s2">&quot;None&quot;</span><span class="p">]:</span>
            <span class="n">button</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">prog_language</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">button</span><span class="p">)</span>
            <span class="n">button</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;clicked&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_selection_button_clicked</span><span class="p">)</span>

        <span class="c1">#setting up the layout, putting the treeview in a scrollwindow, and the buttons in a row</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scrollable_treelist</span> <span class="o">=</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">ScrolledWindow</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scrollable_treelist</span><span class="o">.</span><span class="n">set_vexpand</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scrollable_treelist</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">attach_next_to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">scrollable_treelist</span><span class="p">,</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">PositionType</span><span class="o">.</span><span class="n">BOTTOM</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">button</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">attach_next_to</span><span class="p">(</span><span class="n">button</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buttons</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">PositionType</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scrollable_treelist</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">treeview</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">show_all</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">language_filter_func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="nb">iter</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Tests if the language in the row is the one in the filter&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_filter_language</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_filter_language</span> <span class="o">==</span> <span class="s2">&quot;None&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">model</span><span class="p">[</span><span class="nb">iter</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_filter_language</span>

    <span class="k">def</span> <span class="nf">on_selection_button_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Called on any of the button clicks&quot;&quot;&quot;</span>
        <span class="c1">#we set the current language filter to the button&#39;s label</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_filter_language</span> <span class="o">=</span> <span class="n">widget</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> language selected!&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_filter_language</span><span class="p">)</span>
        <span class="c1">#we update the filter, which updates in turn the view</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">language_filter</span><span class="o">.</span><span class="n">refilter</span><span class="p">()</span>


<span class="n">win</span> <span class="o">=</span> <span class="n">TreeViewFilterWindow</span><span class="p">()</span>
<span class="n">win</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;destroy&quot;</span><span class="p">,</span> <span class="n">Gtk</span><span class="o">.</span><span class="n">main_quit</span><span class="p">)</span>
<span class="n">win</span><span class="o">.</span><span class="n">show_all</span><span class="p">()</span>
<span class="n">Gtk</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="cellrenderers.html" class="btn btn-neutral float-right" title="12. CellRenderers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="spinner.html" class="btn btn-neutral" title="10. Spinner" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright GNU Free Documentation License 1.3.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'3.4',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>